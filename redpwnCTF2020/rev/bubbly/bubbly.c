//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int64_t __do_global_dtors_aux(void);
int64_t __libc_csu_fini(void);
int64_t __libc_csu_init(int64_t a1, int64_t a2, int64_t a3);
int64_t _fini(void);
int64_t _init(void);
int64_t _start(int64_t a1, int64_t a2, int64_t a3, int64_t a4);
bool check(void);
int64_t deregister_tm_clones(void);
int64_t frame_dummy(void);
int32_t function_1030(char * s);
void function_1040(struct _IO_FILE * stream, char * buf);
int32_t function_1050(char * command);
int32_t function_1060(char * format, ...);
void function_1070(int64_t * d);
void print_flag(void);
int64_t register_tm_clones(void);

// --------------------- Global Variables ---------------------

int64_t g1 = 0x1160; // 0x3de8
int64_t g2 = 0x1120; // 0x3df0
int64_t g3 = 0; // 0x3ff8
struct _IO_FILE * g4 = NULL; // 0x40a0
struct _IO_FILE * g5 = NULL; // 0x40b0
struct _IO_FILE * g6 = NULL; // 0x40c0
char g7 = 0; // 0x40c8
int32_t nums[10] = {1, 10, 3, 2, 5, 9, 8, 7, 4, 6}; // 0x4060
int32_t g8;

// ------------------------ Functions -------------------------

// Address range: 0x1000 - 0x1017
int64_t _init(void) {
    int64_t result = 0; // 0x100e
    if (*(int64_t *)0x3fe8 != 0) {
        // 0x1010
        __gmon_start__();
        result = &g8;
    }
    // 0x1012
    return result;
}

// Address range: 0x1030 - 0x1036
int32_t function_1030(char * s) {
    // 0x1030
    return puts(s);
}

// Address range: 0x1040 - 0x1046
void function_1040(struct _IO_FILE * stream, char * buf) {
    // 0x1040
    setbuf(stream, buf);
}

// Address range: 0x1050 - 0x1056
int32_t function_1050(char * command) {
    // 0x1050
    return system(command);
}

// Address range: 0x1060 - 0x1066
int32_t function_1060(char * format, ...) {
    // 0x1060
    return scanf(format);
}

// Address range: 0x1070 - 0x1076
void function_1070(int64_t * d) {
    // 0x1070
    __cxa_finalize(d);
}

// Address range: 0x1080 - 0x10ab
int64_t _start(int64_t a1, int64_t a2, int64_t a3, int64_t a4) {
    // 0x1080
    int64_t v1; // 0x1080
    __libc_start_main(0x11d9, (int32_t)a4, (char **)&v1, (void (*)())0x1380, (void (*)())0x13e0, (void (*)())a3);
    __asm_hlt();
    // UNREACHABLE
}

// Address range: 0x10b0 - 0x10d9
int64_t deregister_tm_clones(void) {
    // 0x10b0
    return 0x4088;
}

// Address range: 0x10e0 - 0x1119
int64_t register_tm_clones(void) {
    // 0x10e0
    return 0;
}

// Address range: 0x1120 - 0x1159
int64_t __do_global_dtors_aux(void) {
    // 0x1120
    if (g7 != 0) {
        // 0x1158
        int64_t result; // 0x1120
        return result;
    }
    // 0x1129
    if (g3 != 0) {
        // 0x1137
        __cxa_finalize((int64_t *)*(int64_t *)0x4048);
    }
    int64_t result2 = deregister_tm_clones(); // 0x1143
    g7 = 1;
    return result2;
}

// Address range: 0x1160 - 0x1165
int64_t frame_dummy(void) {
    // 0x1160
    return register_tm_clones();
}

// From module:   /mnt/c/Users/chris/Desktop/sorting (2)/sorting/main.c
// Address range: 0x1165 - 0x11bf
// Line range:    8 - 20
bool check(void) {
    uint64_t v1 = 0;
    bool result = true; // 0x11b7
    while (v1 < 9) {
        int64_t v2 = v1 + 1;
        uint32_t v3 = *(int32_t *)(4 * v2 + (int64_t)&nums); // 0x11a2
        result = false;
        if (*(int32_t *)(4 * v1 + (int64_t)&nums) > v3) {
            // break -> 0x11b9
            break;
        }
        v1 = v2;
        result = true;
    }
    // 0x11b9
    return result;
}

// From module:   /mnt/c/Users/chris/Desktop/sorting (2)/sorting/main.c
// Address range: 0x11bf - 0x11d9
// Line range:    22 - 25
void print_flag(void) {
    // 0x11bf
    system("cat flag.txt");
}

// From module:   /mnt/c/Users/chris/Desktop/sorting (2)/sorting/main.c
// Address range: 0x11d9 - 0x137f
// Line range:    27 - 58
int main() {
    // 0x11d9
    setbuf(g4, NULL);
    setbuf(g5, NULL);
    setbuf(g6, NULL);
    puts("I hate my data structures class! Why can't I just sort by hand?");
    int64_t v1; // bp-20, 0x11d9
    scanf("%d", &v1);
    if ((int32_t)v1 >= 9) {
        // 0x136c
        puts("Try again!");
        // 0x1378
        return 0;
    }
    int64_t v2 = 4 * v1; // 0x1257
    int32_t * v3 = (int32_t *)((v2 & 0x3fffffffc) + (int64_t)&nums); // 0x1268
    *v3 = *(int32_t *)((v2 + 4 & 0x3fffffffc) + (int64_t)&nums) ^ *v3;
    int64_t v4 = 4 * v1; // 0x12a3
    int32_t * v5 = (int32_t *)((v4 + 4 & 0x3fffffffc) + (int64_t)&nums); // 0x12b7
    *v5 = *(int32_t *)((v4 & 0x3fffffffc) + (int64_t)&nums) ^ *v5;
    int64_t v6 = 4 * v1; // 0x12f2
    int32_t * v7 = (int32_t *)((v6 & 0x3fffffffc) + (int64_t)&nums); // 0x1303
    *v7 = *(int32_t *)((v6 + 4 & 0x3fffffffc) + (int64_t)&nums) ^ *v7;
    bool v8 = check(); // 0x1340
    scanf("%d", &v1);
    while ((int32_t)v1 < 9) {
        // 0x1254
        v2 = 4 * v1;
        v3 = (int32_t *)((v2 & 0x3fffffffc) + (int64_t)&nums);
        *v3 = *(int32_t *)((v2 + 4 & 0x3fffffffc) + (int64_t)&nums) ^ *v3;
        v4 = 4 * v1;
        v5 = (int32_t *)((v4 + 4 & 0x3fffffffc) + (int64_t)&nums);
        *v5 = *(int32_t *)((v4 & 0x3fffffffc) + (int64_t)&nums) ^ *v5;
        v6 = 4 * v1;
        v7 = (int32_t *)((v6 & 0x3fffffffc) + (int64_t)&nums);
        *v7 = *(int32_t *)((v6 + 4 & 0x3fffffffc) + (int64_t)&nums) ^ *v7;
        v8 = check();
        scanf("%d", &v1);
    }
    if (v8) {
        // 0x1354
        puts("Well done!");
        print_flag();
        // 0x1378
        return 0;
    }
    // 0x136c
    puts("Try again!");
    // 0x1378
    return 0;
}

// Address range: 0x1380 - 0x13dd
int64_t __libc_csu_init(int64_t a1, int64_t a2, int64_t a3) {
    int64_t result = _init(); // 0x13a8
    if ((int64_t)&g2 - (int64_t)&g1 >> 3 == 0) {
        // 0x13ce
        return result;
    }
    int64_t v1 = 0; // 0x13b1
    while (v1 + 1 != (int64_t)&g2 - (int64_t)&g1 >> 3) {
        // 0x13b8
        v1++;
    }
    // 0x13ce
    return result;
}

// Address range: 0x13e0 - 0x13e1
int64_t __libc_csu_fini(void) {
    // 0x13e0
    int64_t result; // 0x13e0
    return result;
}

// Address range: 0x13e4 - 0x13ed
int64_t _fini(void) {
    // 0x13e4
    int64_t result; // 0x13e4
    return result;
}

// --------------- Dynamically Linked Functions ---------------

// void __cxa_finalize(void * d);
// void __gmon_start__(void);
// int __libc_start_main(int *(main)(int, char **, char **), int argc, char ** ubp_av, void(* init)(void), void(* fini)(void), void(* rtld_fini)(void), void(* stack_end));
// int puts(const char * s);
// int scanf(const char * restrict format, ...);
// void setbuf(FILE * restrict stream, char * restrict buf);
// int system(const char * command);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (8.3.0)
// Detected language: C
// Detected functions: 17
